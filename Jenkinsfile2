pipeline{
    agent any
    parameters{
        choice(name: "CHOSEN_SERVICE", choices: ["service1", "service2"])
    }
    stages{
        stage ("Building Docker Image"){
            steps{
                sh "docker build . -f 'files/$params.CHOSEN_SERVICE' -t 'testimage_$params.CHOSEN_SERVICE:latest'"
            }
        }
        stage ("Tag Image and Push"){
            steps{
                sh "docker tag 'testimage_$params.CHOSEN_SERVICE:latest' 'realmisterpotato/testimage_$params.CHOSEN_SERVICE:latest'"
            }
        }
        stage ("Deploy with Ansible"){
            steps{
                echo 'Deploy with ansible'
            }
        }
    }
}